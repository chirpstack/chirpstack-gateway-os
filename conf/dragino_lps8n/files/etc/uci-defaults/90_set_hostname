if [ "$(uci -q get system.@system[0].hostname)" != "OpenWrt" ]; then
    exit 0
fi

. /lib/functions.sh
. /lib/functions/system.sh

GWID_END=$(mtd_get_mac_binary art 0x6 | awk -F\: '{print $4$5$6}')

uci set system.@system[0].hostname="chirpstack-${GWID_END}"
uci commit system
echo $(uci get system.@system[0].hostname) > /proc/sys/kernel/hostname
